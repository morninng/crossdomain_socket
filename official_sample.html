<html>
<head>
	<script type="text/javascript" src="https://127.0.0.1:3000/socket.io.js"></script>
	<script type="text/javascript" src="https://127.0.0.1:3000/socket.io-stream.js"></script>
	<script src="https://127.0.0.1:3000/javascripts/jquery.js"></script>
	<script src="https://127.0.0.1:3000/javascripts/recording.js"></script>
</head>
<body>



<input type="file" id="input_files" name="files[]" multiple />
<br><br><br>

<input type="button" id="startRecord" value="Start Recording">
<input type="button" id="stopRecord" value="Stop Recording">





<script>

	var audio_record_obj = new Recording();


	var socket_io = io.connect('https://127.0.0.1:3000/');

  socket_io.on('connect', function(){

	  function handleFileSelect(evt){
	  	var self = this;
	  	var files = evt.target.files;
	  	for (var i = 0, file; file = files[i]; i++) {
	  		var reader = new FileReader();
	  		reader.readAsArrayBuffer(file);
	  		reader.onprogress = self.upload_file = function(e){
			  	console.log("upload file called");
			  	console.log(e.target.result);
					socket_io.emit('file_upload', {filename:"aaa", buffer: e.target.result})
			  }
	  	}
	  }
	  audio_record_obj.set_socket(socket_io);

  	document.getElementById('input_files').addEventListener('click', handleFileSelect, false);
  	document.getElementById('startRecord').addEventListener('click', audio_record_obj.start_record, false);
  	document.getElementById('stopRecord').addEventListener('click', audio_record_obj.stop_record, false);

	  socket_io.on('disconnect', function(){
			audio_record_obj.set_socket(null);
	  });

	});


</script>






</body>
</html>

